## Storage > Object Storage > コンソール使用ガイド

## コンテナ
### コンテナ作成
コンテナを作成します。オブジェクトストレージにオブジェクトをアップロードするには1つ以上のコンテナが必要です。暗号化設定を行うとアップロードしたオブジェクトを自動的に暗号化して保存します。

<table class="it" style="padding-top: 15px; padding-bottom: 10px;">
  <tr>
    <th>分類</th>
    <th>項目</th>
    <th>説明</th>
  </tr>
  <tr>
    <td rowspan="4">コンテナ作成</td>
    <td>名前</td>
    <td>コンテナ名は英字256文字、日本語85文字に制限されます。</td>
  </tr>
  <tr>
    <td rowspan="2">コンテナアクセスポリシー</td>
    <td><b>PRIVATE</b>：許可されたユーザーのみコンテナ内部のオブジェクトにアクセスできます。</td>
  </tr>
  <tr>
    <td><b>PUBLIC</b>：公開URLから誰でもコンテナ内部のオブジェクトにアクセスできます。</td>
  </tr>
  <tr>
    <td>ストレージクラス</td>
    <td><b>Standard</b>：基本クラスです。</td>
  </tr>
  <tr>
    <td rowspan="2">オブジェクトロック設定</td>
    <td>オブジェクトロック</td>
    <td>オブジェクトロックを使用するかどうかを選択します。</td>
  </tr>
  <tr>
    <td>ロック周期</td>
    <td>オブジェクトロック周期を日単位で入力します。</td>
  </tr>
  <tr>
    <td rowspan="2">暗号化設定</td>
    <td>暗号化</td>
    <td>オブジェクト暗号化を使用するかどうかを選択します。</td>
  </tr>
  <tr>
    <td>対称鍵ID </td>
    <td>Secure Key Managerサービスで管理する対称鍵IDを入力します。</td>
  </tr>
</table>

#### オブジェクトロック設定
オブジェクトロックコンテナにアップロードしたオブジェクトは、**WORM (Write-Once-Read-Many)**モデルを使用して保存されます。オブジェクトロックコンテナにアップロードしたオブジェクトにはロック有効期限が設定されます。各オブジェクトに設定されたロック有効期限以前にはオブジェクトの上書きや削除ができません。

#### 暗号化設定
暗号化コンテナにアップロードするオブジェクトはNHN CloudのSecure Key Managerサービスで管理する対称鍵を使用して暗号化されます。したがって暗号化コンテナを作成するには、あらかじめSecure Key Managerサービスで対称鍵を作成する必要があります。

暗号化コンテナに適用されるポリシーは次のとおりです。

* 暗号化コンテナにアップロードするオブジェクトは、設定された対称鍵を使用して暗号化され保存されます。
* 暗号化されたオブジェクトをダウンロードすると復号されて転送されます。 
* 暗号化コンテナのオブジェクトをコピーまたはリージョン間コンテナ複製を行って他のコンテナにコピーすると、対象コンテナの暗号化設定に基づいて再暗号化または復号されて保存されます。
* 暗号化コンテナを作成する時、登録した対称鍵IDは変更できません。対称鍵を変更するにはSecure Key Managerサービスでキーのローテーションを行う必要があります。
* Secure Key Managerサービスで暗号化コンテナに設定した対称鍵をローテーションした後、新しいオブジェクトをアップロードすると、以前のバージョンの鍵で暗号化されたオブジェクトがローテーションされた鍵で再暗号化されます。この作業は使用量によって処理時間が長くなる場合があります。再暗号化が完了する前に以前のバージョンの鍵を削除しないように注意する必要があります。

> [注意]
Secure Key Managerサービスで暗号化コンテナに設定した対称鍵を削除した場合、暗号化されたオブジェクトを復号できません。対称鍵を誤って削除しないように注意して管理する必要があります。

### コンテナ削除
選択したコンテナを削除します。コンテナを削除する前にコンテナが空になっているかを確認する必要があります。コンテナ内にオブジェクトが残っている場合は削除できません。

### コンテナ管理
選択したコンテナの基本情報を確認し、設定を管理します。

#### 基本情報
コンテナの基本情報と暗号化情報を確認し、アクセスポリシー、静的Webサイト、オリジン間リソース共有などの設定を変更できます。
<br/>

##### コンテナアクセスポリシー

基本アクセスポリシーを設定し、テナントまたは個別ユーザー単位でロールベースのアクセスポリシーを管理します。アクセスポリシーの詳細については[アクセスポリシー設定ガイド](acl-guide/)を参照してください。

<table class="it" style="padding-top: 15px; padding-bottom: 10px;">
  <tr>
    <th>分類</th>
    <th>項目</th>
    <th>説明</th>
  </tr>
  <tr>
    <td rowspan="2">基本アクセスポリシー</td>
    <td>PRIVATE</td>
    <td>許可されたユーザーのみコンテナ内部のオブジェクトにアクセスできます。</td>
  </tr>
  <tr>
    <td>PUBLIC</td>
    <td>公開URLを通じて、誰でもコンテナ内部のオブジェクトにアクセスできます。</td>
  </tr>
  <tr>
    <td rowspan="4">ACL設定</td>
    <td></td>
    <td>個別アクセスポリシーを使用するかどうかを選択します。</td>
  </tr>
  </tr>
  <tr>
    <td>テナントID</td>
    <td>アクセスを許可するテナントIDまたは <code>*</code>を入力します。テナントIDはコンソールのAPI Endpoint設定ダイアログボックスで確認できます。</td>
  </tr>
  <tr>
    <td>APIユーザーID</td>
    <td>アクセスを許可するAPIユーザーIDまたは<code>*</code>を入力します。 APIユーザーIDはコンソールのAPI Endpoint設定ダイアログボックスで確認できます。</td>
  </tr>
  <tr>
    <td>権限</td>
    <td>許可するアクセス権限(<code>Read</code>、<code>Write</code>)を選択します。</td>
  </tr>
</table>

<br/>

##### IP ACL

IPベースのアクセスポリシーを管理します。アクセスポリシーの詳細については[アクセスポリシー設定ガイド](acl-guide/)を参照してください。

<table class="it" style="padding-top: 15px; padding-bottom: 10px;">
  <tr>
    <th>分類</th>
    <th>項目</th>
    <th>説明</th>
  </tr>
  <tr>
    <td rowspan="2">ホワイトリスト</td>
    <td>IPv4</td>
    <td>ホワイトリストに登録するIPを入力します。 IP(192.168.0.1)またはCIDR(192.168.0.0/24)形式で入力できます。</td>
  </tr>
  <tr>
    <td>権限</td>
    <td>許可するアクセス権限(Read, Write)を選択します。</td>
  </tr>
  <tr>
    <td rowspan="2">ブラックリスト</td>
    <td>IPv4</td>
    <td>ブラックリストに登録するIPを入力します。 IP(192.168.0.1)またはCIDR(192.168.0.0/24)形式で入力できます。</td>
  </tr>
  </tr>
  <tr>
    <td>権限</td>
    <td>許可しないアクセス権限(Read, Write)を選択します。</td>
  </tr>
</table>


##### 静的Webサイト設定

<table class="it" style="padding-top: 15px; padding-bottom: 10px;">
  <tr>
    <th>分類</th>
    <th>項目</th>
    <th>説明</th>
  </tr>
  <tr>
    <td rowspan="2">静的Webサイト設定</td>
    <td>インデックス文書</td>
    <td>静的Webサイトのインデックス文書オブジェクトを入力します。オブジェクトがフォルダ内にある場合、フォルダパスを含めて入力する必要があります。<br/>最大256バイト、英字、数字、一部特殊文字(<code>-</code>、<code>_</code>、<code>.</code>、<code>/</code>)のみ入力できます。</td>
  </tr>
  <tr>
    <td>エラー文書</td>
    <td>静的Webサイトのエラー文書オブジェクトのサフィックス(suffix)を入力します。エラー文書サフィックスにはフォルダパスを含まられません。<br/>最大256バイト、英字、
数字、一部特殊文字(<code>-</code>、<code>_</code>、<code>.</code>、<code>/</code>)のみ入力できます。</td>
  </tr>
</table>

コンテナのアクセスポリシーを**PUBLIC**に設定し、インデックス文書とエラー文書を入力するとコンテナで静的Webサイトをホスティングできます。静的WebサイトURLはコンテナリストで**URLコピー**ボタンをクリックして取得できます。

静的Webサイトのインデックス文書、エラー文書として使用するオブジェクトは、1つ以上の英字、数字または一部特殊文字(`-`, `_`, `.`, `/`)で構成された名前でなければなりません。またファイル拡張子が`.html`のハイパーテキスト形式でなければなりません。条件に合わないと、設定できない場合や静的Webサイトが動作しない場合があります。

静的Webサイトのエラー文書名は`{レスポンスコード}{サフィックス}`の形式です。例えば、エラー文書を`error.html`に設定した場合、404エラーが発生した時に表示されるエラー文書の名前は`404error.html`になります。各エラー状況に合わせてエラー文書をアップロードして使用できます。エラー文書を定義していない場合や、レスポンスコードに合ったエラー文書オブジェクトがない場合は、Webブラウザの基本エラー文書が表示されます。
<br/>

##### オリジン間リソース共有(CORS)変更

ブラウザでObject Storage APIを直接呼び出すには、オリジン間リソース共有設定が必要です。オリジン間リソース共有項目の変更ボタンをクリックすると、許可するソースURLを登録できます。 URLにはプロトコル(`https://`または`http://`)が含まれている必要があります。`*`を登録するとすべてのソースを許可できます。

<br/>

#### ライフサイクルおよびバージョン管理

コンテナに保存されるオブジェクトのライフサイクルとバージョン管理ポリシーを照会し、変更できます。

<table class="it" style="padding-top: 15px; padding-bottom: 10px;">
  <tr>
    <th>分類</th>
    <th>項目</th>
    <th>説明</th>
  </tr>
  <tr>
    <td>オブジェクトのライフサイクル</td>
    <td></td>
    <td>オブジェクトのライフサイクルを日単位で入力します。空欄にするとライフサイクル設定が解除されます。</td>
  </tr>
  <tr>
    <td rowspan="3">オブジェクト<br/>バージョン管理ポリシー</td>
    <td>バージョン管理ポリシー</td>
    <td>バージョン管理ポリシーを使用するかどうかを選択します。</td>
  </tr>
  <tr>
    <td>アーカイブコンテナ</td>
    <td>オブジェクトの以前のバージョンを保管するコンテナを入力します。</td>
  </tr>
  <tr>
    <td>アーカイビングオブジェクト<br/>ライフサイクル</td>
    <td>オブジェクトの以前のバージョンのライフサイクルを日単位で入力します。空欄にするとライフサイクル設定が解除されます。</td>
  </tr>
</table>

##### オブジェクトライフサイクル

アップロードしたオブジェクトの基本ライフサイクルを設定できます。設定されたライフサイクルが終了したオブジェクトは自動的に削除されます。

> [参考]
> オブジェクトライフサイクル設定後にアップロードしたオブジェクトにのみ適用されます。

##### オブジェクトバージョン管理設定

オブジェクトバージョン管理設定からオブジェクトの以前のバージョンを保管できます。オブジェクトをアップデートまたは削除する時、以前のバージョンが指定されたアーカイブコンテナに保管されます。以前のバージョンのライフサイクルを設定した場合、ライフサイクルを超過した以前のバージョンは自動的に削除されます。

> [注意]
> アーカイブコンテナを原本コンテナより先に削除すると、原本コンテナのオブジェクトをアップデートまたは削除する時にエラーが発生します。すでに削除している場合はアーカイブコンテナを新たに作成するか原本コンテナのバージョン管理ポリシーを解除して解決できます。
> 暗号化コンテナをアーカイブコンテナとして指定した後、暗号化コンテナの対称鍵をSecure Key Managerサービスから削除すると、原本コンテナのオブジェクトアップロードと削除に失敗します。

#### オブジェクトロック

オブジェクトロックコンテナのオブジェクトロック周期を確認し、変更できます。ロック周期は日単位で入力でき、解除できません。 

<table class="it" style="padding-top: 15px; padding-bottom: 10px;">
  <tr>
    <th>分類</th>
    <th>項目</th>
    <th>説明</th>
  </tr>
  <tr>
    <td rowspan="2">オブジェクトロック設定</td>
    <td>オブジェクトロック</td>
    <td>オブジェクトロックを使用するかどうかを選択します。</td>
  </tr>
  <tr>
    <td>ロック周期</td>
    <td>オブジェクトロック周期を日単位で入力します。</td>
  </tr>
</table>

> [参考]
> 変更されたオブジェクトロック周期は設定変更後にアップロードしたオブジェクトに適用されます。 
> 一般コンテナをオブジェクトロックコンテナに変更したり、オブジェクトロックコンテナを一般コンテナに変更できません。
> オブジェクトロックコンテナはアーカイブコンテナまたは複製対象コンテナに指定できません。

#### 複製

複製設定を行ってコンテナのオブジェクトを他のリージョンのコンテナに複製できます。複製設定は災害復旧(disaster recovery)のための機能で、原本リージョンのオブジェクトを対象リージョンに同じように複製し、管理します。複製はバックグラウンドで一定周期ごとに行われます。

<table class="it" style="padding-top: 15px; padding-bottom: 10px;">
  <tr>
    <th>分類</th>
    <th>項目</th>
    <th>説明</th>
  <tr>
    <td rowspan="3">複製設定</td>
    <td>複製</td>
    <td>複製機能を使用するかどうかを選択します。</td>
  </tr>
  <tr>
    <td>対象リージョン</td>
    <td>現在利用中のリージョン以外の複製する対象リージョンを選択します。</td>
  </tr>
  <tr>
    <td>複製コンテナ</td>
    <td>複製対象コンテナを入力します。</td>
  </tr>
</table>

複製ポリシーは次のとおりです。

* ソースコンテナでオブジェクトを変更(アップロード、アップデート、削除)すると、複製対象コンテナに同じように反映されます。
* 複製対象コンテナで変更されたオブジェクトはソースコンテナに反映されません。
* 複製対象コンテナで複製されたオブジェクトを変更すると、そのオブジェクトはソースオブジェクトに変更があっても複製されない可能性があります。
* 複製対象コンテナは空のコンテナを使用することを推奨します。対象コンテナにソースコンテナのオブジェクトと同じ名前のオブジェクトがすでに存在する場合、複製が円滑に行われない可能性があります。
* 複製対象コンテナを削除すると、同じ名前のコンテナを再度作成しても複製が再開されません。複製を再開するには複製設定をもう一度行う必要があります。
* 複製対象コンテナを別のリージョンに複製したり、他のコンテナの複製対象コンテナに重複設定することはできません。
* 複製設定を**使用しない**に変更すると複製は中断されますが、すでに複製されたオブジェクトは保持されます。
* ソースコンテナと複製対象コンテナの名前を同じにすることを推奨します。コンテナの名前が異なる場合、複製された大容量オブジェクトへのアクセスに失敗する可能性があります。
* マルチパートアップロードした大容量オブジェクトのセグメントオブジェクトが他のコンテナに保存されている場合は、そのコンテナも複製設定を行うと複製された大容量オブジェクトにアクセスできます。

> [注意]
> 暗号化コンテナを複製対象コンテナとして指定した後、暗号化コンテナの対称鍵をSecure Key Managerサービスから削除すると、暗号化コンテナの複製に失敗します。


## オブジェクト
### フォルダ作成
フォルダを作成します。フォルダはコンテナのオブジェクトをグループにまとめるための仮想の単位です。WindowsのフォルダやLinuxのディレクトリと同じように階層構造でオブジェクトを管理できるようにします。フォルダ名は英字256文字、日本語85文字に制限されます。

> [参考]
> オブジェクトストレージのフォルダはファイルシステムが提供するディレクトリとは概念が異なります。便宜のために提供する疑似(pseudo)フォルダです。フォルダを作成すると、実際には`{フォルダ-名前}/`という空のオブジェクトが作成されます。フォルダ内のオブジェクトは`{フォルダ-名前}/{オブジェクト-名前}`形式の名前を持ちます。オブジェクトコピー機能を利用して新しいフォルダにオブジェクトをコピーすると、`{フォルダ-名前}/`形式の空のオブジェクトではなく、`{フォルダ-名前}/{オブジェクト-名前}`形式のオブジェクトが作成されます。したがって、このコピーされたオブジェクトを削除する場合、フォルダまで削除されたように表示されます。あらかじめ作ったフォルダにコピーする時はフォルダのオブジェクトを削除してもフォルダが残っています。

### フォルダ削除
フォルダを削除します。フォルダを削除する前にフォルダが空になっているか確認する必要があります。フォルダ内にオブジェクトが残っている場合は削除できません。

### オブジェクトアップロード
すべてのオブジェクトはコンテナ内にアップロードする必要があります。オブジェクト1つの最大容量は5GBに制限されます。

> [参考]
> Webコンソールでは5GBを超えるファイルはアップロードできません。アップロードするオブジェクトの容量が5GBを超える場合は、`split`などのコマンドラインツールを使用して分割するか、ユーザーアプリケーションで5GB以下のサイズに分割してアップロードするようにプログラミングする必要があります。詳細な使用方法はAPIガイドの[マルチパートアップロード](api-guide/#_43)を参考にしてください。

### オブジェクトのダウンロード
選択したオブジェクトをダウンロードします。コンテナを作る時、コンテナアクセスポリシーを**PRIVATE**に設定している場合、許可されたユーザーのみオブジェクトにアクセスできます。**PUBLIC**に設定していると、リストで`URLコピー`ボタンを押してオブジェクトの公開URLを確認できます。このURLでオブジェクトのハイパーリンクを作成したり、オブジェクトを直接ダウンロードできます。

<details style="padding-top: 15px; padding-bottom: 10px;">
<summary>ハイパーリンク例</summary>
<ul style="padding-left: 10px; padding-top: 10px;">
<li>Webページ作成</li>

```
# cat > index.html
<html>
<body> hello world!
<a href="https://kr1-api-object-storage.nhncloudservice.com/v1/{account}/{container}/{object}">Download</a>
</body>
</html>
```

<li>Python3のhttpモジュールを利用してWebサーバー実行</li>
```
# python -m http.server
Serving HTTP on :: port 8000 (http://[::]:8000/) ...
```

<li>Webブラウザで<b>http://localhost:8000</b>に接続した後、<b>Download</b>を押して正常にファイルがダウンロードできるかを確認</li>

</details>


### オブジェクトのコピー
オブジェクトをコピーして新しいオブジェクトを作成します。コピーするオブジェクトがあるコンテナに新しい名前のオブジェクトを作ったり、他のコンテナにオブジェクトをコピーできます。

> [参考]
> 入力することができるパスの最大長さはオブジェクト名によって変わります。コピーするパスにオブジェクト名を加えた長さが1024バイト以下である必要があります。
> `{パスの最大長さ} = 1024 - {オブジェクト名の長さ} - 1`
>
> 5GBを超えるマルチパートオブジェクトはコピーできません。 

### オブジェクトの削除
選択したオブジェクトを削除します。マルチパートオブジェクトを削除するとセグメントオブジェクトも一緒に削除されます。

### 署名されたURLの作成
ロールベースのアクセスポリシーに関係なく、設定した時間の間、指定したオブジェクトに自由にアクセスできる署名されたURLを作成します。

> [参考]
> 単一オブジェクトのみ選択でき、フォルダオブジェクトは選択できません。
> 有効期間は、最大720分まで分単位で設定できます。
> [注意]
> 署名されたURLが流出すると、誰でも選択したオブジェクトにアクセスできるため、注意して使用する必要があります。署名されたURLが流出しても被害を軽減できるように、状況と用途に合わせて適切な有効期間を設定して使用することを推奨します。

### オブジェクト管理
選択したオブジェクトの基本情報を確認し、プロパティを管理します。

> [参考]
オブジェクトの有効期限とロック有効期限の両方を設定する場合は、オブジェクトの有効期限を常にロック有効期限以降に設定する必要があります。
##### オブジェクトの有効期限を変更

選択したオブジェクトの有効期限を変更できます。

#### オブジェクトのロック有効期限を変更

選択したオブジェクトのロック有効期限を変更できます。以前に設定された有効期限より前には変更できません。

## プレフィックス検索
検索ウィンドウにプレフィックスを入力して**検索**ボタンを押すと、入力したプレフィックスで始まるコンテナ、フォルダ、オブジェクトを検索できます。コンテナリストではコンテナを、オブジェクトリストではフォルダとオブジェクトを検索します。

## S3 API認証情報
Amazon S3互換APIを使用するための認証情報を発行できます。S3 API認証情報は有効期限がなく、ユーザーごとにプロジェクトあたり最大3個まで発行できます。

> [注意]
> S3 API認証情報キーが漏洩すると、誰でも漏洩したキーを利用してオブジェクトにアクセスできます。キーが漏洩した場合は漏洩した認証情報を削除して、新しく発行して使用することを推奨します。
> 
